<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Quizzes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #b30000;
            text-align: center;
        }
        .container {
            display: flex;
            gap: 20px;
        }
        .configurador {
            flex: 1;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .previsualizacion {
            flex: 1;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .quiz-output {
            width: 100%;
            height: 300px;
            font-family: monospace;
        }
        button {
            background-color: #b30000;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #990000;
        }
        .pregunta {
            margin-bottom: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .opcion {
            margin-left: 20px;
            margin-bottom: 5px;
        }
        .quiz-preview {
            padding: 15px;
            border: 2px solid #b30000;
            border-radius: 10px;
            background-color: #fff0f0;
            font-family: sans-serif;
        }
        .quiz-title {
            color: #b30000;
        }
        .correct-option {
            background-color: #e6ffe6;
        }
    </style>
</head>
<body>
    <h1>Generador de Quizzes para Docentes</h1>
    
    <div class="container">
        <div class="configurador">
            <h2>Configura tu Quiz</h2>
            
            <div>
                <label for="quiz-title">T√≠tulo del Quiz:</label>
                <input type="text" id="quiz-title" value="üß† Mini Quiz - Generalidades del aparato locomotor" style="width: 100%;">
            </div>
            
            <div id="preguntas-container">
                <!-- Las preguntas se agregar√°n aqu√≠ -->
            </div>
            
            <button id="agregar-pregunta">‚ûï Agregar Pregunta</button>
            <button id="generar-codigo">Generar C√≥digo</button>
        </div>
        
        <div class="previsualizacion">
            <h2>Previsualizaci√≥n</h2>
            <div id="quiz-preview" class="quiz-preview">
                <h3 class="quiz-title" id="preview-title">üß† Mini Quiz - Generalidades del aparato locomotor</h3>
                <p>Aqu√≠ aparecer√° la previsualizaci√≥n de tu quiz...</p>
            </div>
            
            <h3>C√≥digo generado:</h3>
            <textarea id="quiz-output" class="quiz-output" readonly></textarea>
            <button id="copiar-codigo">Copiar C√≥digo</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let preguntaCount = 0;
            const preguntasContainer = document.getElementById('preguntas-container');
            const agregarPreguntaBtn = document.getElementById('agregar-pregunta');
            const generarCodigoBtn = document.getElementById('generar-codigo');
            const copiarCodigoBtn = document.getElementById('copiar-codigo');
            const quizPreview = document.getElementById('quiz-preview');
            const quizOutput = document.getElementById('quiz-output');
            const previewTitle = document.getElementById('preview-title');
            const quizTitleInput = document.getElementById('quiz-title');
            
            // Agregar primera pregunta por defecto
            agregarPregunta();
            
            // Event listeners
            agregarPreguntaBtn.addEventListener('click', agregarPregunta);
            generarCodigoBtn.addEventListener('click', generarCodigo);
            copiarCodigoBtn.addEventListener('click', copiarCodigo);
            quizTitleInput.addEventListener('input', actualizarTituloPreview);
            
            function actualizarTituloPreview() {
                previewTitle.textContent = quizTitleInput.value;
            }
            
            function agregarPregunta() {
                preguntaCount++;
                const preguntaId = `pregunta-${preguntaCount}`;
                
                const preguntaDiv = document.createElement('div');
                preguntaDiv.className = 'pregunta';
                preguntaDiv.id = preguntaId;
                
                preguntaDiv.innerHTML = `
                    <div>
                        <label><strong>Pregunta ${preguntaCount}:</strong></label>
                        <input type="text" class="texto-pregunta" placeholder="Texto de la pregunta" style="width: 100%;">
                    </div>
                    <div id="opciones-${preguntaId}">
                        <!-- Opciones se agregar√°n aqu√≠ -->
                    </div>
                    <button class="agregar-opcion" data-pregunta="${preguntaId}">‚ûï Agregar Opci√≥n</button>
                    <button class="eliminar-pregunta" data-pregunta="${preguntaId}">üóëÔ∏è Eliminar Pregunta</button>
                `;
                
                preguntasContainer.appendChild(preguntaDiv);
                
                // Agregar 3 opciones por defecto
                const opcionesContainer = document.getElementById(`opciones-${preguntaId}`);
                for (let i = 0; i < 3; i++) {
                    agregarOpcion(preguntaId, opcionesContainer);
                }
                
                // Event listeners para los botones de esta pregunta
                preguntaDiv.querySelector(`.agregar-opcion`).addEventListener('click', function() {
                    agregarOpcion(preguntaId, opcionesContainer);
                });
                
                preguntaDiv.querySelector(`.eliminar-pregunta`).addEventListener('click', function() {
                    if (confirm('¬øEst√°s seguro de que quieres eliminar esta pregunta?')) {
                        preguntasContainer.removeChild(preguntaDiv);
                        actualizarNumeracionPreguntas();
                    }
                });
                
                actualizarNumeracionPreguntas();
                actualizarPreview();
            }
            
            function agregarOpcion(preguntaId, opcionesContainer) {
                const preguntaNum = preguntaId.split('-')[1];
                const opcionCount = opcionesContainer.children.length + 1;
                const opcionId = `opcion-${preguntaId}-${opcionCount}`;
                const letraOpcion = String.fromCharCode(96 + opcionCount); // a, b, c, etc.
                
                const opcionDiv = document.createElement('div');
                opcionDiv.className = 'opcion';
                
                opcionDiv.innerHTML = `
                    <input type="radio" name="correcta-${preguntaId}" value="${letraOpcion}" id="correcta-${opcionId}" ${opcionCount === 1 ? 'checked' : ''}>
                    <label for="correcta-${opcionId}">Correcta</label>
                    <input type="text" class="texto-opcion" placeholder="Texto de la opci√≥n ${letraOpcion}" data-letra="${letraOpcion}" style="width: 60%;">
                    <button class="eliminar-opcion">üóëÔ∏è</button>
                `;
                
                opcionesContainer.appendChild(opcionDiv);
                
                // Event listeners para esta opci√≥n
                opcionDiv.querySelector('.eliminar-opcion').addEventListener('click', function() {
                    if (opcionesContainer.children.length > 1) {
                        opcionesContainer.removeChild(opcionDiv);
                        actualizarLetrasOpciones(opcionesContainer);
                        actualizarPreview();
                    } else {
                        alert('Cada pregunta debe tener al menos una opci√≥n.');
                    }
                });
                
                opcionDiv.querySelector('.texto-opcion').addEventListener('input', actualizarPreview);
                
                actualizarPreview();
            }
            
            function actualizarLetrasOpciones(opcionesContainer) {
                const opciones = opcionesContainer.querySelectorAll('.opcion');
                opciones.forEach((opcion, index) => {
                    const letra = String.fromCharCode(97 + index);
                    opcion.querySelector('input[type="radio"]').value = letra;
                    opcion.querySelector('input[type="radio"]').id = `correcta-${opcion.id.split('-').slice(0, 2).join('-')}-${letra}`;
                    opcion.querySelector('label').htmlFor = `correcta-${opcion.id.split('-').slice(0, 2).join('-')}-${letra}`;
                    opcion.querySelector('.texto-opcion').dataset.letra = letra;
                });
            }
            
            function actualizarNumeracionPreguntas() {
                const preguntas = preguntasContainer.querySelectorAll('.pregunta');
                preguntas.forEach((pregunta, index) => {
                    const num = index + 1;
                    pregunta.id = `pregunta-${num}`;
                    pregunta.querySelector('label strong').textContent = `Pregunta ${num}:`;
                    
                    // Actualizar los data-atributos de los botones
                    pregunta.querySelector('.agregar-opcion').dataset.pregunta = `pregunta-${num}`;
                    pregunta.querySelector('.eliminar-pregunta').dataset.pregunta = `pregunta-${num}`;
                    
                    // Actualizar el id del contenedor de opciones
                    const opcionesContainer = pregunta.querySelector('[id^="opciones-"]');
                    opcionesContainer.id = `opciones-pregunta-${num}`;
                });
            }
            
            function actualizarPreview() {
                const preguntas = preguntasContainer.querySelectorAll('.pregunta');
                let previewHTML = `<h3 class="quiz-title">${quizTitleInput.value || 'üß† Mini Quiz'}</h3>`;
                
                if (preguntas.length === 0) {
                    previewHTML += '<p>No hay preguntas configuradas.</p>';
                } else {
                    preguntas.forEach((pregunta, index) => {
                        const preguntaTexto = pregunta.querySelector('.texto-pregunta').value || `Pregunta ${index + 1} sin texto`;
                        const opciones = pregunta.querySelectorAll('.opcion');
                        
                        previewHTML += `<p><strong>${index + 1}. ${preguntaTexto}</strong></p>`;
                        
                        opciones.forEach((opcion, opcionIndex) => {
                            const letra = String.fromCharCode(97 + opcionIndex);
                            const opcionTexto = opcion.querySelector('.texto-opcion').value || `Opci√≥n ${letra} sin texto`;
                            const esCorrecta = opcion.querySelector('input[type="radio"]').checked;
                            
                            previewHTML += `
                                <div class="${esCorrecta ? 'correct-option' : ''}">
                                    <input type="radio" name="preview-q${index + 1}" disabled>
                                    <label>${letra}. ${opcionTexto}</label><br>
                                </div>
                            `;
                        });
                        
                        previewHTML += '<br>';
                    });
                }
                
                quizPreview.innerHTML = previewHTML;
            }
            
            function generarCodigo() {
                const preguntas = preguntasContainer.querySelectorAll('.pregunta');
                let quizHTML = `<div style="padding: 15px; border: 2px solid #b30000; border-radius: 10px; background-color: #fff0f0; max-width: 600px; font-family: sans-serif;">
  <h3 style="color: #b30000;">${quizTitleInput.value || 'üß† Mini Quiz'}</h3>\n\n`;
                
                // Generar HTML para cada pregunta
                preguntas.forEach((pregunta, index) => {
                    const preguntaTexto = pregunta.querySelector('.texto-pregunta').value || `Pregunta ${index + 1} sin texto`;
                    const opciones = pregunta.querySelectorAll('.opcion');
                    let respuestaCorrecta = '';
                    
                    quizHTML += `  <!-- Pregunta ${index + 1} -->
  <p><strong>${index + 1}. ${preguntaTexto}</strong></p>\n`;
                    
                    opciones.forEach((opcion, opcionIndex) => {
                        const letra = String.fromCharCode(97 + opcionIndex);
                        const opcionTexto = opcion.querySelector('.texto-opcion').value || `Opci√≥n ${letra} sin texto`;
                        
                        if (opcion.querySelector('input[type="radio"]').checked) {
                            respuestaCorrecta = letra;
                        }
                        
                        quizHTML += `  <input type="radio" name="q${index + 1}" value="${letra}" id="q${index + 1}${letra}">
  <label for="q${index + 1}${letra}">${opcionTexto}</label><br>\n`;
                    });
                    
                    quizHTML += '<br>\n';
                });
                
                // A√±adir el bot√≥n y el feedback
                quizHTML += `  <button onclick="revisarQuiz()" style="background-color: #b30000; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer;">Revisar respuestas</button>
  <p id="feedbackQuiz" style="margin-top: 15px; font-weight: bold;"></p>
</div>\n\n`;
                
                // Generar el JavaScript con las respuestas correctas
                let jsCode = `<script>
  function revisarQuiz() {
    const respuestas = {\n`;
                
                preguntas.forEach((pregunta, index) => {
                    const opciones = pregunta.querySelectorAll('.opcion');
                    let respuestaCorrecta = '';
                    
                    opciones.forEach(opcion => {
                        if (opcion.querySelector('input[type="radio"]').checked) {
                            respuestaCorrecta = opcion.querySelector('input[type="radio"]').value;
                        }
                    });
                    
                    jsCode += `      q${index + 1}: "${respuestaCorrecta}"${index < preguntas.length - 1 ? ',' : ''}\n`;
                });
                
                jsCode += `    };
    let correctas = 0;
    let respondidas = 0;
    const totalPreguntas = ${preguntas.length};

    for (let q in respuestas) {
      const opciones = document.getElementsByName(q);
      for (let o of opciones) {
        if (o.checked) {
          respondidas++;
          if (o.value === respuestas[q]) correctas++;
        }
      }
    }

    const feedback = document.getElementById("feedbackQuiz");
    if (respondidas < totalPreguntas) {
      feedback.innerHTML = "‚ö†Ô∏è Asegurate de responder todas las preguntas.";
      feedback.style.color = "#cc6600";
    } else if (correctas === totalPreguntas) {
      feedback.innerHTML = "üéâ ¬°Excelente! ¬°Respondiste todo correctamente!";
      feedback.style.color = "green";
    } else {
      feedback.innerHTML = \`üîÅ Respondiste correctamente \${correctas} de \${totalPreguntas}. ¬°Repas√° y volv√© a intentarlo!\`;
      feedback.style.color = "#b30000";
    }
  }
<\/script>`;
                
                quizOutput.value = quizHTML + jsCode;
            }
            
            function copiarCodigo() {
                quizOutput.select();
                document.execCommand('copy');
                alert('¬°C√≥digo copiado al portapapeles!');
            }
            
            // Actualizar preview cuando cambian los textos de las preguntas
            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('texto-pregunta') || 
                    e.target.classList.contains('texto-opcion')) {
                    actualizarPreview();
                }
            });
            
            // Actualizar preview cuando cambia la opci√≥n correcta
            document.addEventListener('change', function(e) {
                if (e.target.type === 'radio' && e.target.name.startsWith('correcta-')) {
                    actualizarPreview();
                }
            });
        });
    </script>
</body>
</html>
